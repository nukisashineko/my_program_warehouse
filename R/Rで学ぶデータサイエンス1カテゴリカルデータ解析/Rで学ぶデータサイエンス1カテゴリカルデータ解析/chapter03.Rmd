---
title: "chapter03"
author: "nukisashineko"
date: "2015年06月13日"
output: html_document
---

#割合に関数る統計的な推測

##統計的推測の必要性
- 目的集団  
- 母集団  
    - 標本  

##２つのカテゴリーを持つ変数
二項分布適応可能   
${}_n{C}_xp^x(1-p)^{n-x}$
```{r}
#２０人調査した時に８人が中心となるカテゴリが５割
#「あたり」を引く可能性は５割だと聞いていたが、20個を開けたら８個しか「あたり」が入っていなかった。これは、５割という確率が間違っているという可能性は無いのか？
binom.test(8,20,0.5)
#間違っているって強く言える証拠ではないよ。
```

##信頼区間の意味
```{r}
dbinom(8,20,0.4)

n <- 20; p<-0.4;
x<-c(0:n)
y<-array(dbinom(x,n,p))
barplot(y,main=paste("n = ",n,", p = ",p))
```

**信頼区間(confidence interval)**  
Ｘpの値（割合）が調査によって変動する  
Ｏ信頼区間が実験や調査ごとにばらつく。  


```{r}
#5個の乱数(0.4の確率で20回試行時の成功回数）の取得
rbinom(5,20,0.4)
```
```{r}
set.seed(1)
rbinom(5,20,0.4)
```

その他乱数関数
```{r,eval=FALSE}
runif
rnorm
rexp
```

binomテストは難しい。  
だから、従来の正規分布のシュミュレーションは  
```{r}
n<-20; x<-8;
p <- x/n
sd <- sqrt(x* (n-x)/n)/n
c(p - 1.96*sd, p+ 1.96*sd)
```
ちょっとだけずれているけど正しい

##割合に関する検定
- 検定
    - 帰無仮説(null hypothesis)
    - 対立仮説(altrernative hypothesis)
- 統計的検定
- 棄却域
- 有意水準 == p-value
- 大数の法則

```{r}
binom.test(405,765,0.5)
binom.test(405,765,0.4)
```

男子 34537, 女子 32613,総数 67150  
男子の発生率は1/2か  
```{r}
binom.test(34537,67150,0.5)
```
えっと、これは言えないらしい。  
0.51になってるみたい  


##３つ以上のカテゴリをもつ変数の場合
今回は血液型  

|血液型|A|B|C|D|合計|  
|----|----|----|----|----|----|  
|人数|39|16|27|15|97|  

これの発生率は000.1％
```{r}
p <- c(0.382, 0.219, 0.305, 0.094)
x <- c(39,16,27,15)
dmultinom(x, prob =p)
```

###割合の推定
```{r}
#A型のみについて考える　
#信頼区間は 0.3037398 0.5065310
binom.test(39,97)
```

###適合度検定

**適合度のカイの二乗統計量**

サイコロを３００回投げた結果それぞれの目が62,54,53,38,46,49回出た。
この結果に対して、「サイコロはそれぞれ等しい確率は偽である」を調べるには
```{r}
x <- c(62,54,53,38,46,49)
p0 <- c(1/6,1/6,1/6,1/6,1/6,1/6)
chisq.test(x, p=p0)
```
今回は棄却できなかった。



##練習問題

A.1
```{r}
binom.test(134,200)# ->９５％信頼区間は（ 0.6001707 0.7347018）
```

A.2
```{r}
#コインを３００回投げた時に145回裏が出た、素の裏が出る確率は３割と言っていいか
#ANSWER = ダメです。
binom.test(145,300,0.3)
```

A.3
```{r}
#講義の受けた人の血液型は一般よりずれているのか？
#ANSWER = 完全に一致しています。
p <- c(0.382, 0.219, 0.305, 0.094)
x <- c(0.382,0.219,0.305,0.094)
dmultinom(x, prob =p)
```

